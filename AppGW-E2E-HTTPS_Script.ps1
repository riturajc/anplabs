Install-WindowsFeature -Name Web-Server -IncludeManagementTools
New-NetFirewallRule -Name "Allowhttp" -DisplayName "Allowhttp" -Profile "Any" -Direction "inbound" -Action "Allow" -LocalPort "443" -Protocol "TCP"
New-NetFirewallRule -Name "AllowRDP" -DisplayName "AllowRDP" -Profile "Any" -Direction "inbound" -Action "Allow" -LocalPort "3389" -Protocol "TCP"
mkdir c:\inetpub\http
Add-Content -Path c:\inetpub\http\iisstart.htm -Value "You are connected Using End to End http"
New-IISSite -Name "http" -PhysicalPath c:\inetpub\http -BindingInformation "*:80:http.internal.fabrikam.com" -Protocol HTTP
mkdir c:\Temp1
Add-Content -Value "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" -Path C:\temp1\pfx-encoded-bytes.txt
certutil -decode c:\temp1\pfx-encoded-bytes.txt c:\temp1\backend.pfx
certutil -f -p Password1 -importpfx c:\temp1\backend.pfx

mkdir c:\inetpub\https
Add-Content -Path c:\inetpub\https\iisstart.htm -Value "You are connected Using End to End SSL"
New-IISSite -Name "https" -PhysicalPath c:\inetpub\https -BindingInformation "*:443:https.internal.fabrikam.com" -Protocol HTTPS -certificatethumbprint "522d14be9c08189454b6a709e7a55fc975c30b0a" -certstorelocation "Cert:\LocalMachine\My" 
